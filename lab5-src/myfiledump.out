0x0000000000000000: 23 69 6E 63 6C 75 64 65 20 3C 73 74 64 69 6F 2E  #include <stdio.
0x0000000000000010: 68 3E 0A 23 69 6E 63 6C 75 64 65 20 3C 73 74 72  h>.#include <str
0x0000000000000020: 69 6E 67 2E 68 3E 0A 23 69 6E 63 6C 75 64 65 20  ing.h>.#include 
0x0000000000000030: 3C 73 74 64 6C 69 62 2E 68 3E 0A 0A 20 76 6F 69  <stdlib.h>.. voi
0x0000000000000040: 64 20 66 69 6C 65 64 75 6D 70 28 63 68 61 72 20  d filedump(char 
0x0000000000000050: 2A 20 70 20 2C 20 69 6E 74 20 6C 65 6E 29 20 7B  * p , int len) {
0x0000000000000060: 0A 20 20 20 20 20 20 20 20 20 20 0A 09 20 20 69  .          ..  i
0x0000000000000070: 6E 74 20 61 3B 0A 09 20 20 63 68 61 72 20 73 6F  nt a;..  char so
0x0000000000000080: 6C 75 74 69 6F 6E 5B 31 37 5D 3B 0A 0A 20 20 20  lution[17];..   
0x0000000000000090: 20 20 20 20 20 20 20 6C 6F 6E 67 20 69 6E 74 20         long int 
0x00000000000000A0: 6C 6F 63 61 74 69 6F 6E 3B 0A 09 20 20 6C 6F 63  location;..  loc
0x00000000000000B0: 61 74 69 6F 6E 3D 20 30 3B 0A 20 20 20 20 20 20  ation= 0;.      
0x00000000000000C0: 20 20 20 20 6C 6F 6E 67 20 69 6E 74 20 63 68 61      long int cha
0x00000000000000D0: 6E 67 65 3B 0A 09 20 20 63 68 61 6E 67 65 20 3D  nge;..  change =
0x00000000000000E0: 20 30 3B 0A 0A 20 20 20 20 20 20 20 20 20 20 66   0;..          f
0x00000000000000F0: 6F 72 28 61 20 3D 20 30 3B 20 61 3C 6C 65 6E 3B  or(a = 0; a<len;
0x0000000000000100: 20 61 2B 2B 29 20 0A 09 20 20 7B 0A 20 0A 20 20   a++) ..  {. .  
0x0000000000000110: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000120: 69 66 28 6C 65 6E 20 3E 3D 20 31 30 30 30 30 30  if(len >= 100000
0x0000000000000130: 30 29 20 20 7B 0A 20 20 20 20 20 20 20 20 20 20  0)  {.          
0x0000000000000140: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000150: 69 66 28 70 5B 61 5D 20 3D 3D 20 27 5C 30 27 29  if(p[a] == '\0')
0x0000000000000160: 0A 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20  .               
0x0000000000000170: 20 20 20 20 20 20 20 20 20 20 20 20 20 62 72 65               bre
0x0000000000000180: 61 6B 3B 0A 20 20 20 20 20 20 20 20 20 20 20 20  ak;.            
0x0000000000000190: 20 20 20 20 20 20 7D 0A 20 20 20 20 20 20 20 20        }.        
0x00000000000001A0: 20 20 20 20 20 20 20 20 20 20 69 66 28 61 25 31            if(a%1
0x00000000000001B0: 36 3D 3D 30 29 20 7B 0A 20 20 20 20 20 20 20 20  6==0) {.        
0x00000000000001C0: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x00000000000001D0: 20 20 70 72 69 6E 74 66 28 22 30 78 25 30 31 36    printf("0x%016
0x00000000000001E0: 6C 58 3A 20 22 2C 20 28 75 6E 73 69 67 6E 65 64  lX: ", (unsigned
0x00000000000001F0: 20 6C 6F 6E 67 29 6C 6F 63 61 74 69 6F 6E 20 2B   long)location +
0x0000000000000200: 20 63 68 61 6E 67 65 20 29 3B 0A 20 20 20 20 20   change );.     
0x0000000000000210: 20 20 20 20 20 20 20 20 20 20 20 20 20 0A 09 09               ...
0x0000000000000220: 20 20 7D 0A 20 20 20 20 20 20 20 20 20 20 20 20    }.            
0x0000000000000230: 20 20 20 20 20 20 69 6E 74 20 63 3B 0A 09 09 20        int c;... 
0x0000000000000240: 20 63 20 3D 20 70 5B 61 5D 26 30 78 46 46 3B 0A   c = p[a]&0xFF;.
0x0000000000000250: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000260: 20 20 70 72 69 6E 74 66 28 22 25 30 32 58 20 22    printf("%02X "
0x0000000000000270: 2C 20 63 29 3B 0A 20 0A 20 20 20 20 20 20 20 20  , c);. .        
0x0000000000000280: 20 20 20 20 20 20 20 20 20 20 73 6F 6C 75 74 69            soluti
0x0000000000000290: 6F 6E 5B 61 25 31 36 5D 20 3D 20 28 28 28 63 20  on[a%16] = (((c 
0x00000000000002A0: 3E 3D 20 33 32 29 20 26 26 20 28 63 20 3C 20 31  >= 32) && (c < 1
0x00000000000002B0: 32 37 29 29 3F 20 28 63 68 61 72 29 63 20 3A 20  27))? (char)c : 
0x00000000000002C0: 27 2E 27 29 3B 0A 20 0A 20 20 20 20 20 20 20 20  '.');. .        
0x00000000000002D0: 20 20 20 20 20 20 20 20 20 20 69 66 28 28 61 20            if((a 
0x00000000000002E0: 2B 20 31 29 25 31 36 3D 3D 30 29 20 20 7B 0A 20  + 1)%16==0)  {. 
0x00000000000002F0: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000300: 20 20 20 20 20 20 20 20 20 73 6F 6C 75 74 69 6F           solutio
0x0000000000000310: 6E 5B 61 20 25 20 31 36 20 2B 20 31 5D 20 3D 20  n[a % 16 + 1] = 
0x0000000000000320: 27 5C 30 27 3B 0A 20 20 20 20 20 20 20 20 20 20  '\0';.          
0x0000000000000330: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000340: 70 72 69 6E 74 66 28 22 20 25 73 5C 6E 22 2C 73  printf(" %s\n",s
0x0000000000000350: 6F 6C 75 74 69 6F 6E 29 3B 0A 20 20 20 20 20 20  olution);.      
0x0000000000000360: 20 20 20 20 20 20 20 20 20 20 20 20 7D 0A 20 0A              }. .
0x0000000000000370: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000380: 20 20 63 68 61 6E 67 65 2B 2B 3B 0A 20 0A 20 0A    change++;. . .
0x0000000000000390: 20 20 20 20 20 20 20 20 20 20 7D 0A 20 0A 20 20            }. .  
0x00000000000003A0: 20 20 20 20 20 20 20 20 69 66 28 61 25 31 36 20          if(a%16 
0x00000000000003B0: 21 3D 30 29 20 7B 0A 20 20 20 20 20 20 20 20 20  !=0) {.         
0x00000000000003C0: 20 20 20 20 20 20 20 20 20 73 6F 6C 75 74 69 6F           solutio
0x00000000000003D0: 6E 5B 61 25 31 36 5D 20 3D 20 27 5C 30 27 3B 0A  n[a%16] = '\0';.
0x00000000000003E0: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x00000000000003F0: 20 20 66 6F 72 28 61 20 3D 20 61 20 25 20 31 36    for(a = a % 16
0x0000000000000400: 3B 20 28 61 20 3C 20 31 36 29 3B 20 61 2B 2B 29  ; (a < 16); a++)
0x0000000000000410: 20 7B 0A 20 20 20 20 20 20 20 20 20 20 20 20 20   {.             
0x0000000000000420: 20 20 20 20 20 20 20 20 20 20 20 20 20 70 72 69               pri
0x0000000000000430: 6E 74 66 28 22 20 20 20 22 29 3B 0A 20 20 20 20  ntf("   ");.    
0x0000000000000440: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 7D 0A                }.
0x0000000000000450: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20                  
0x0000000000000460: 20 20 70 72 69 6E 74 66 28 22 20 25 73 5C 6E 22    printf(" %s\n"
0x0000000000000470: 2C 73 6F 6C 75 74 69 6F 6E 29 3B 0A 20 20 20 20  ,solution);.    
0x0000000000000480: 20 20 20 20 20 20 7D 0A 20 0A 20 0A 20 20 7D 0A        }. . .  }.
0x0000000000000490: 20 0A 0A 20 69 6E 74 20 6D 61 69 6E 28 69 6E 74   .. int main(int
0x00000000000004A0: 20 61 72 67 63 2C 20 63 68 61 72 20 2A 2A 61 72   argc, char **ar
0x00000000000004B0: 67 76 29 20 7B 0A 20 20 20 20 20 20 20 20 20 20  gv) {.          
0x00000000000004C0: 69 6E 74 20 6D 62 79 74 65 73 3B 0A 09 20 20 6D  int mbytes;..  m
0x00000000000004D0: 62 79 74 65 73 20 3D 20 30 3B 0A 20 20 20 20 20  bytes = 0;.     
0x00000000000004E0: 20 20 20 20 20 69 66 28 32 20 3E 20 61 72 67 63       if(2 > argc
0x00000000000004F0: 29 0A 20 20 20 20 20 20 20 20 20 20 7B 0A 20 20  ).          {.  
0x0000000000000500: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 70                 p
0x0000000000000510: 72 69 6E 74 66 28 22 55 73 61 67 65 3A 20 6D 79  rintf("Usage: my
0x0000000000000520: 66 69 6C 65 64 75 6D 70 20 66 69 6C 65 6E 61 6D  filedump filenam
0x0000000000000530: 65 20 5B 6D 61 78 62 79 74 65 73 5D 5C 6E 22 29  e [maxbytes]\n")
0x0000000000000540: 3B 0A 20 20 20 20 20 20 20 20 20 20 20 20 20 20  ;.              
0x0000000000000550: 20 20 20 20 65 78 69 74 28 31 29 3B 0A 20 20 20      exit(1);.   
0x0000000000000560: 20 20 20 20 20 20 20 7D 0A 0A 20 20 20 20 20 20         }..      
0x0000000000000570: 20 20 20 20 63 68 61 72 2A 20 66 69 6C 65 4E 61      char* fileNa
0x0000000000000580: 6D 65 20 3D 20 61 72 67 76 5B 31 5D 3B 0A 20 20  me = argv[1];.  
0x0000000000000590: 20 20 20 20 20 20 20 20 46 49 4C 45 2A 20 66 64          FILE* fd
0x00000000000005A0: 20 3D 20 66 6F 70 65 6E 28 66 69 6C 65 4E 61 6D   = fopen(fileNam
0x00000000000005B0: 65 2C 22 72 22 29 3B 0A 20 20 20 20 20 20 20 20  e,"r");.        
0x00000000000005C0: 20 20 0A 09 20 20 69 66 28 66 64 20 3D 3D 20 4E    ..  if(fd == N
0x00000000000005D0: 55 4C 4C 29 7B 0A 20 20 20 20 20 20 20 20 20 20  ULL){.          
0x00000000000005E0: 20 20 20 20 20 20 20 20 0A 09 09 20 20 70 72 69          ...  pri
0x00000000000005F0: 6E 74 66 28 22 45 72 72 6F 72 20 6F 70 65 6E 69  ntf("Error openi
0x0000000000000600: 6E 67 20 66 69 6C 65 20 5C 22 25 73 5C 22 5C 6E  ng file \"%s\"\n
0x0000000000000610: 22 2C 66 69 6C 65 4E 61 6D 65 29 3B 0A 20 20 20  ",fileName);.   
0x0000000000000620: 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 65                 e
0x0000000000000630: 78 69 74 28 31 29 3B 0A 20 20 20 20 20 20 20 20  xit(1);.        
0x0000000000000640: 20 20 7D 0A 20 20 20 20 20 20 20 20 20 20 0A 09    }.          ..
0x0000000000000650: 20 20 66 73 65 65 6B 28 66 64 2C 20 30 4C 2C 20    fseek(fd, 0L, 
0x0000000000000660: 53 45 45 4B 5F 45 4E 44 29 3B 0A 09 20 20 69 6E  SEEK_END);..  in
0x0000000000000670: 74 20 66 69 6C 65 53 69 7A 65 20 3D 20 66 74 65  t fileSize = fte
0x0000000000000680: 6C 6C 28 66 64 29 3B 0A 09 20 20 66 73 65 65 6B  ll(fd);..  fseek
0x0000000000000690: 28 66 64 2C 20 30 4C 2C 20 53 45 45 4B 5F 53 45  (fd, 0L, SEEK_SE
0x00000000000006A0: 54 29 3B 0A 0A 20 20 20 20 20 20 20 20 20 20 63  T);..          c
0x00000000000006B0: 68 61 72 20 2A 20 66 3B 0A 09 20 20 66 20 3D 28  har * f;..  f =(
0x00000000000006C0: 63 68 61 72 20 2A 20 29 6D 61 6C 6C 6F 63 28 66  char * )malloc(f
0x00000000000006D0: 69 6C 65 53 69 7A 65 29 3B 0A 20 20 20 20 20 20  ileSize);.      
0x00000000000006E0: 20 20 20 20 66 72 65 61 64 28 66 2C 28 66 69 6C      fread(f,(fil
0x00000000000006F0: 65 53 69 7A 65 2B 31 29 2C 31 2C 66 64 29 3B 0A  eSize+1),1,fd);.
0x0000000000000700: 0A 20 20 20 20 20 20 20 20 20 20 69 66 28 61 72  .          if(ar
0x0000000000000710: 67 63 20 3D 3D 33 29 7B 0A 20 20 20 20 20 20 20  gc ==3){.       
0x0000000000000720: 20 20 20 20 20 20 20 20 20 20 20 0A 20 20 20 20             .    
0x0000000000000730: 20 20 20 20 20 20 6D 62 79 74 65 73 3D 61 74 6F        mbytes=ato
0x0000000000000740: 69 28 61 72 67 76 5B 32 5D 29 3B 0A 09 20 20 69  i(argv[2]);..  i
0x0000000000000750: 66 28 6D 62 79 74 65 73 20 3C 20 66 69 6C 65 53  f(mbytes < fileS
0x0000000000000760: 69 7A 65 29 7B 0A 09 20 20 66 69 6C 65 64 75 6D  ize){..  filedum
0x0000000000000770: 70 28 66 2C 20 6D 62 79 74 65 73 29 3B 0A 09 20  p(f, mbytes);.. 
0x0000000000000780: 20 7D 0A 09 20 20 65 6C 73 65 7B 0A 09 20 20 66   }..  else{..  f
0x0000000000000790: 69 6C 65 64 75 6D 70 28 66 2C 20 66 69 6C 65 53  iledump(f, fileS
0x00000000000007A0: 69 7A 65 29 3B 0A 09 20 20 7D 0A 09 20 7D 20 0A  ize);..  }.. } .
0x00000000000007B0: 20 20 20 20 20 20 20 20 20 20 0A 09 20 65 6C 73            .. els
0x00000000000007C0: 65 7B 0A 20 20 20 20 20 20 20 20 20 20 66 69 6C  e{.          fil
0x00000000000007D0: 65 64 75 6D 70 28 66 20 2C 20 66 69 6C 65 53 69  edump(f , fileSi
0x00000000000007E0: 7A 65 29 3B 0A 20 20 20 20 20 20 20 20 20 20 7D  ze);.          }
0x00000000000007F0: 0A 20 20 20 20 20 20 20 20 20 20 72 65 74 75 72  .          retur
0x0000000000000800: 6E 20 31 3B 0A 20 20 7D 0A                       n 1;.  }.
